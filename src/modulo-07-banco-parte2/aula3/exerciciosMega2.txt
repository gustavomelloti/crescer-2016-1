CREATE PROCEDURE IMPRIMIRGANHADORES(PIDCONCURSO IN INTEGER)
AS

VQTDQUADRA INTEGER;
VQTDQUINA INTEGER;
VQTDMEGA INTEGER;
CURSOR P_GANHADORES IS
    SELECT COUNT(*) QUANTIDADEACERTOS
    FROM CONCURSO
    INNER JOIN APOSTA ON APOSTA.IDCONCURSO =  CONCURSO.IDCONCURSO
    INNER JOIN NUMERO_APOSTA ON NUMERO_APOSTA.IDAPOSTA = APOSTA.IDAPOSTA  AND NUMERO_APOSTA.NUMERO IN (CONCURSO.PRIMEIRA_DEZENA, CONCURSO.SEGUNDA_DEZENA, CONCURSO.TERCEIRA_DEZENA, CONCURSO.QUARTA_DEZENA, CONCURSO.QUINTA_DEZENA, CONCURSO.SEXTA_DEZENA)
    WHERE CONCURSO.IDCONCURSO = PIDCONCURSO
    GROUP BY (APOSTA.IDAPOSTA)
    HAVING COUNT(*) > 3;
    
BEGIN
   VQTDQUADRA := 0;
   VQTDQUINA := 0;
   VQTDMEGA := 0;
  
    FOR GAN IN P_GANHADORES LOOP
        IF (GAN.QUANTIDADEACERTOS = 4) THEN
            VQTDQUADRA := VQTDQUADRA +1;
        ELSIF (GAN.QUANTIDADEACERTOS = 5) THEN
            VQTDQUINA := VQTDQUINA +1;
        ELSIF (GAN.QUANTIDADEACERTOS = 6) THEN
            VQTDMEGA := VQTDMEGA +1;
        END IF;
    END LOOP;
  
    dbms_output.put_line('Quantidade ganhadores QUADRA: ' || VQTDQUADRA);
    dbms_output.put_line('Quantidade ganhadores QUINA: ' || VQTDQUINA);
    dbms_output.put_line('Quantidade ganhadores MEGA: ' || VQTDMEGA);
END;


EXEC IMPRIMIRGANHADORES(1816);
