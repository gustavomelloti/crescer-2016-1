--1
SELECT CLIENTE.NOME, CLIENTE.IDCLIENTE, CIDADE.NOME CIDADE, CIDADE.UF
FROM CLIENTE
INNER JOIN CIDADE ON CLIENTE.IDcidade = CIDADE.IDCIDADE

--2

SELECT COUNT(*)
FROM PEDIDO
WHERE EXTRACT(MONTH FROM DATAPEDIDO) = 4 AND EXTRACT(YEAR FROM DATAPEDIDO) = 2016

--3
SELECT * FROM CLIENTE
WHERE LOWER(CLIENTE.NOME) LIKE '%ltda%' OR LOWER(CLIENTE.RAZAOSOCIAL) LIKE '%ltda%' 

--4
CREATE SEQUENCE SQPRODUTO START WITH 8001
INSERT INTO Produto (IDPRODUTO, NOME, PRECOCUSTO, PRECOVENDA, SITUACAO) Values (SQPRODUTO.NEXTVAL, 'Galocha Maragato', 35.67, 77.95, 'A')

--5
SELECT PRODUTO.IDPRODUTO, PRODUTO.NOME
FROM PRODUTO
WHERE NOT EXISTS(
	SELECT 1 
 	FROM PEDIDOITEM
 	WHERE PEDIDOITEM.IDPRODUTO = PRODUTO.IDPRODUTO
)

--6
SELECT PEDIDO.IDPEDIDO, PEDIDO.DATAPEDIDO, PRODUTO.NOME, PEDIDOITEM.QUANTIDADE, PEDIDOITEM.PRECOUNITARIO , PEDIDOITEM.QUANTIDADE * PEDIDOITEM.PRECOUNITARIO as PROCETOTALITEM
FROM CLIENTE
INNER JOIN PEDIDO ON PEDIDO.IDCLIENTE = CLIENTE.IDCLIENTE
INNER JOIN PEDIDOITEM ON PEDIDOITEM.IDPEDIDO = PEDIDO.IDPEDIDO
INNER JOIN PRODUTO ON PRODUTO.IDPRODUTO = PEDIDOITEM.IDPRODUTO
WHERE CLIENTE.IDCLIENTE = :PIDCLIENTE

--7
SELECT SUM(PEDIDOITEM.QUANTIDADE)
FROM PEDIDO
INNERJOIN PEDIDOITEM ON PEDIDOITEM.IDPEDIDO = PEDIDO.IDPEDIDO
WHERE PEDIDOITEM.IDPRODUTO = :PIDPRODUTO AND EXTRACT(YEAR FROM PEDIDO.DATAPEDIDO) = '2016'

--8
SELECT COUNT(DISTINCT PEDIDO.IDPEDIDO) QUANTIDADEPEDIDOS,
  TO_CHAR(PEDIDO.DATAPEDIDO, 'mm/yyyy') PERIODO,
  SUM(VALORPEDIDO) VALORTOTALPEDIDOS,
  MAX(VALORPEDIDO) VALORMAIORPEDIDO,
  MIN(VALORPEDIDO) VALORMENORPEDIDO,
  AVG(VALORPEDIDO) VALORMEDIAPEDIDOS,
  COUNT(distinct PEDIDOITEM.IDPRODUTO) AS TOTALPRODUTOSDISTINTOS
FROM PEDIDO
INNER JOIN PEDIDOITEM ON PEDIDOITEM.IDPEDIDO = PEDIDO.IDPEDIDO
GROUP BY TO_CHAR(PEDIDO.DATAPEDIDO, 'mm/yyyy')