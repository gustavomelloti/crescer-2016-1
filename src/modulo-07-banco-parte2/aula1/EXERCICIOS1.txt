--1
SELECT CLIENTE.NOME, CLIENTE.IDCLIENTE, CIDADE.NOME CIDADE, CIDADE.UF
FROM CLIENTE
INNER JOIN CIDADE ON CLIENTE.IDcidade = CIDADE.IDCIDADE

--2

SELECT COUNT(*)
FROM PEDIDO
WHERE EXTRACT(MONTH FROM DATAPEDIDO) = 4 AND EXTRACT(YEAR FROM DATAPEDIDO) = 2016

--3
SELECT * FROM CLIENTE
WHERE CLIENTE.NOME LIKE '%ltda%' OR CLIENTE.RAZAOSOCIAL LIKE '%ltda%' 

--4
CREATE SEQUENCE SQPRODUTO START WITH 8001
INSERT INTO Produto (IDPRODUTO, NOME, PRECOCUSTO, PRECOVENDA, SITUACAO) Values (SQPRODUTO.NEXTVAL, 'Galocha Maragato', 35.67, 77.95, 'A')

--5
SELECT PRODUTO.*
FROM PRODUTO
LEFT JOIN PEDIDOITEM ON PEDIDOITEM.IDPRODUTO = PRODUTO.IDPRODUTO
WHERE PEDIDOITEM.IDPRODUTO IS NULL

--6
SELECT PEDIDO.IDPEDIDO, PEDIDO.DATAPEDIDO, PRODUTO.NOME, PEDIDOITEM.QUANTIDADE, PEDIDOITEM.PRECOUNITARIO , PEDIDOITEM.QUANTIDADE * PEDIDOITEM.PRECOUNITARIO as PROCETOTALITEM
FROM CLIENTE
INNER JOIN PEDIDO ON PEDIDO.IDCLIENTE = CLIENTE.IDCLIENTE
INNER JOIN PEDIDOITEM ON PEDIDOITEM.IDPEDIDO = PEDIDO.IDPEDIDO
INNER JOIN PRODUTO ON PRODUTO.IDPRODUTO = PEDIDOITEM.IDPRODUTO
WHERE CLIENTE.IDCLIENTE = :PIDCLIENTE

--7
SELECT SUM(PEDIDOITEM.QUANTIDADE)
FROM PEDIDO
LEFT JOIN PEDIDOITEM ON PEDIDOITEM.IDPEDIDO = PEDIDO.IDPEDIDO
WHERE PEDIDOITEM.IDPRODUTO = :PIDPRODUTO AND EXTRACT(YEAR FROM PEDIDO.DATAPEDIDO) = '2016'

--8
SELECT 
  TO_CHAR(PEDIDO.DATAPEDIDO, 'MON-YYYY') PERIODO, 
  COUNT(PEDIDO.IDPEDIDO) QUANTIDADE,
  SUM(PEDIDOITEM.QUANTIDADE * PEDIDOITEM.PRECOUNITARIO) VALORTOTAL,
  MIN(PEDIDOITEM.QUANTIDADE * PEDIDOITEM.PRECOUNITARIO) VALORMINIMO,
  MAX(PEDIDOITEM.QUANTIDADE * PEDIDOITEM.PRECOUNITARIO) VALORMINIMO
FROM PEDIDO
INNER JOIN PEDIDOITEM ON PEDIDOITEM.IDPEDIDO = PEDIDO.IDPEDIDO
GROUP BY TO_CHAR(PEDIDO.DATAPEDIDO, 'MON-YYYY')
